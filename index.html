<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>–≠–∫—Å–ø–æ—Ä—Ç —Å—É–±—Ç–∏—Ç—Ä–æ–≤ –∏–∑ CapCut –≤ SRT (–û–Ω–ª–∞–π–Ω –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä)</title>
  <meta name="description"
    content="–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å—É–±—Ç–∏—Ç—Ä–æ–≤ –∏ —Ç–µ–∫—Å—Ç–∞ –∏–∑ –ø—Ä–æ–µ–∫—Ç–æ–≤ CapCut PC. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π—Ç–µ draft_content.json –≤ SRT –∑–∞ 1 –∫–ª–∏–∫. –†–∞–±–æ—Ç–∞–µ—Ç —Å –∞–≤—Ç–æ—Å—É–±—Ç–∏—Ç—Ä–∞–º–∏ –∏ —Ä—É—á–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º.">
  <meta name="keywords"
    content="CapCut, SRT, export subtitles, json to srt, extract text, capcut converter, —Å–∫–∞—á–∞—Ç—å —Å—É–±—Ç–∏—Ç—Ä—ã –∫–∞–ø–∫–∞—Ç, —ç–∫—Å–ø–æ—Ä—Ç —Ç–µ–∫—Å—Ç–∞, —Å—É–±—Ç–∏—Ç—Ä—ã –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞">
  <meta name="author" content="barashik07">

  <meta property="og:title" content="CapCut SRT Extractor | –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä">
  <meta property="og:description"
    content="–í—ã—Ç–∞—â–∏ —Å—É–±—Ç–∏—Ç—Ä—ã –∏ —Ç–µ–∫—Å—Ç –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ CapCut (draft_content.json) –∏ —Å–æ—Ö—Ä–∞–Ω–∏ –≤ SRT. –ë–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://barashik07.github.io/capsrt/">
  <meta property="og:image" content="https://barashik07.github.io/capsrt/preview.png">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">

  <link rel="icon"
    href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üé¨</text></svg>">
  <style>
    :root {
      --bg-color: #0d0e12;
      --card-bg: #1a1c23;
      --text-main: #ffffff;
      --text-muted: #a0a0a0;
      --accent-gradient: linear-gradient(135deg, #00f2ea 0%, #ff0050 100%);
      --accent-glow: 0 0 20px rgba(0, 242, 234, 0.3);
      --border-color: #333;
      --success-color: #2ecc71;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Outfit', sans-serif;
      background-color: var(--bg-color);
      color: var(--text-main);
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2rem 1rem;
    }

    .container {
      max-width: 800px;
      width: 100%;
      z-index: 10;
    }

    /* Header */
    header {
      text-align: center;
      margin-bottom: 3rem;
      position: relative;
    }

    h1 {
      font-size: 3rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      background: var(--accent-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      letter-spacing: -0.05em;
    }

    .subtitle {
      color: var(--text-muted);
      font-size: 1.1rem;
      margin-bottom: 1rem;
    }

    .warning-note {
      background: rgba(255, 165, 0, 0.1);
      border: 1px solid rgba(255, 165, 0, 0.3);
      color: #ffb74d;
      padding: 0.75rem 1rem;
      border-radius: 12px;
      font-size: 0.9rem;
      display: inline-block;
      max-width: 600px;
    }

    /* Drop Zone */
    .drop-zone {
      background: var(--card-bg);
      border: 2px dashed var(--border-color);
      border-radius: 24px;
      padding: 3rem 2rem;
      text-align: center;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: pointer;
      position: relative;
      overflow: hidden;
      margin-bottom: 3rem;
    }

    .drop-zone:hover,
    .drop-zone.drag-over {
      border-color: #fff;
      transform: translateY(-2px);
      box-shadow: 0 10px 40px -10px rgba(0, 0, 0, 0.5);
    }

    .drop-zone.drag-over {
      background: #252830;
    }

    .icon-upload {
      font-size: 3rem;
      margin-bottom: 1rem;
      opacity: 0.5;
      transition: opacity 0.3s;
    }

    .drop-zone:hover .icon-upload {
      opacity: 1;
      animation: float 3s ease-in-out infinite;
    }

    @keyframes float {

      0%,
      100% {
        transform: translateY(0);
      }

      50% {
        transform: translateY(-10px);
      }
    }

    .drop-text-main {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .drop-text-sub {
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    #fileInput {
      display: none;
    }

    /* Actions */
    .actions {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.5rem;
      margin-top: 2rem;
    }

    /* Mode Switch */
    .mode-switch {
      display: flex;
      background: rgba(0, 0, 0, 0.3);
      padding: 4px;
      border-radius: 50px;
      position: relative;
      border: 1px solid var(--border-color);
      width: fit-content;
      margin: 0 auto;
    }

    .mode-switch input {
      display: none;
    }

    .mode-switch label {
      position: relative;
      z-index: 2;
      display: block;
      padding: 8px 25px;
      cursor: pointer;
      font-size: 0.9rem;
      color: var(--text-muted);
      transition: color 0.3s;
      border-radius: 50px;
      font-weight: 500;
      min-width: 140px;
      text-align: center;
    }

    .mode-switch input:checked+label {
      color: white;
      text-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
    }

    .switch-indicator {
      position: absolute;
      top: 4px;
      left: 4px;
      bottom: 4px;
      width: calc(50% - 4px);
      background: var(--accent-gradient);
      border-radius: 50px;
      transition: transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
      box-shadow: var(--accent-glow);
      z-index: 1;
    }

    /* Logic for switch position */
    #mode-all:checked~.switch-indicator {
      transform: translateX(100%);
    }

    .file-info {
      background: rgba(255, 255, 255, 0.05);
      padding: 0.5rem 1rem;
      border-radius: 12px;
      font-size: 0.9rem;
      display: none;
      align-items: center;
      gap: 0.5rem;
      animation: slideDown 0.3s ease-out;
    }

    .btn {
      background: var(--accent-gradient);
      color: white;
      border: none;
      padding: 1rem 3rem;
      border-radius: 50px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: var(--accent-glow);
      opacity: 0.5;
      pointer-events: none;
      transform: scale(0.95);
    }

    .btn.active {
      opacity: 1;
      pointer-events: auto;
      transform: scale(1);
    }

    .btn:hover {
      filter: brightness(1.1);
      transform: scale(1.05);
    }

    .status-msg {
      height: 24px;
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    .status-msg.error {
      color: #ff4757;
    }

    .status-msg.success {
      color: var(--success-color);
    }

    /* Instructions */
    .instructions {
      margin-top: 2rem;
    }

    .section-title {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .section-title::before {
      content: '';
      display: block;
      width: 4px;
      height: 24px;
      background: var(--accent-gradient);
      border-radius: 2px;
    }

    .steps {
      display: grid;
      gap: 1.5rem;
    }

    .step-card {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 1.5rem;
      position: relative;
      padding-left: 4rem;
      transition: transform 0.2s;
    }

    .step-card:hover {
      transform: translateX(4px);
      border-color: #555;
    }

    .step-num {
      position: absolute;
      left: 1.5rem;
      top: 1.5rem;
      font-size: 1.5rem;
      font-weight: 700;
      color: rgba(255, 255, 255, 0.1);
      font-family: monospace;
    }

    .code-box {
      background: #000;
      padding: 1rem;
      border-radius: 8px;
      margin: 0.5rem 0;
      font-family: 'Fira Code', monospace;
      font-size: 0.85rem;
      color: #70d6ff;
      border: 1px solid #333;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 8px;
    }

    .code-text {
      word-break: break-all;
    }

    .copy-btn {
      background: rgba(255, 255, 255, 0.1);
      border: none;
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.8rem;
    }

    .copy-btn:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    /* Animations */
    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .background-glow {
      position: fixed;
      width: 600px;
      height: 600px;
      background: radial-gradient(circle, rgba(0, 242, 234, 0.05) 0%, rgba(0, 0, 0, 0) 70%);
      top: -200px;
      left: 50%;
      transform: translateX(-50%);
      z-index: -1;
      pointer-events: none;
    }
  </style>
</head>

<body>

  <div class="background-glow"></div>

  <div class="container">
    <header>
      <h1>CapCut SRT Extractor</h1>
      <p class="subtitle">–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ç–∏—Ç—Ä—ã –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ CapCut –≤ —Å—É–±—Ç–∏—Ç—Ä—ã (.srt) –∑–∞ –ø–∞—Ä—É —Å–µ–∫—É–Ω–¥</p>

      <div class="warning-note">
        üí° <strong>–í–∞–∂–Ω–æ:</strong> –î–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ —Å—É–±—Ç–∏—Ç—Ä–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –∏—Ö –≤–Ω—É—Ç—Ä–∏ –°ap–°ut <em>(–°—É–±—Ç–∏—Ç—Ä—ã -
          –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—É–±—Ç–∏—Ç—Ä—ã - –°–æ–∑–¥–∞—Ç—å)</em>.
      </div>
    </header>

    <main>
      <div class="drop-zone" id="dropZone">
        <div class="icon-upload">üìÇ</div>
        <div class="drop-text-main">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ draft_content.json —Å—é–¥–∞</div>
        <div class="drop-text-sub">–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª</div>
        <input type="file" id="fileInput" accept=".json,application/json">

        <div class="actions">
          <div class="file-info" id="fileInfo">
            <span id="fileName">project.json</span>
          </div>

          <!-- Mode Toggle -->
          <div class="mode-switch">
            <input type="radio" name="mode" id="mode-subs" value="subs" checked>
            <label for="mode-subs">–¢–æ–ª—å–∫–æ —Å—É–±—Ç–∏—Ç—Ä—ã</label>

            <input type="radio" name="mode" id="mode-all" value="all">
            <label for="mode-all">–°—É–±—Ç–∏—Ç—Ä—ã + –¢–µ–∫—Å—Ç</label>

            <div class="switch-indicator"></div>
          </div>

          <button id="convertBtn" class="btn">–°–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ SRT</button>
          <div id="status" class="status-msg"></div>
        </div>
      </div>

      <div class="instructions">
        <h2 class="section-title">
          –ö–∞–∫ –Ω–∞–π—Ç–∏ –Ω—É–∂–Ω—ã–π —Ñ–∞–π–ª?
          <img src="https://guap.ru/content/studlife/logos/dance.png" alt="logo"
            style="height: 1.5em; vertical-align: middle;">
        </h2>
        <div class="steps">
          <div class="step-card">
            <span class="step-num">01</span>
            <p>CapCut —Ö—Ä–∞–Ω–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–µ–∫—Ç–µ (—Ç–µ–∫—Å—Ç, —Ç–∞–π–º–∏–Ω–≥–∏, —Å—Ç–∏–ª–∏) –≤ JSON —Ñ–∞–π–ª–µ.</p>
            <p>–ù–∞–∂–º–∏—Ç–µ <kbd style="background:#333; padding:2px 6px; border-radius:4px;">Win</kbd> + <kbd
                style="background:#333; padding:2px 6px; border-radius:4px;">R</kbd> –Ω–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ.</p>
          </div>
          <div class="step-card">
            <span class="step-num">02</span>
            <p>–í—Å—Ç–∞–≤—å—Ç–µ —ç—Ç—É —Å—Ç—Ä–æ–∫—É –≤ –æ—Ç–∫—Ä—ã–≤—à–µ–µ—Å—è –æ–∫–Ω–æ –∏ –Ω–∞–∂–º–∏—Ç–µ <strong>Enter</strong>:</p>
            <div class="code-box">
              <span class="code-text" id="pathText">%localappdata%\CapCut\User Data\Projects\com.lveditor.draft\</span>
              <button class="copy-btn" onclick="copyPath()">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
          </div>
          <div class="step-card">
            <span class="step-num">03</span>
            <p>–û—Ç–∫—Ä–æ–µ—Ç—Å—è –ø–∞–ø–∫–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π –º–Ω–æ–≥–æ —Å—Ç—Ä–∞–Ω–Ω—ã—Ö –ø–∞–ø–æ–∫ —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –∏–∑ –±—É–∫–≤ –∏ —Ü–∏—Ñ—Ä.</p>
            <p>–û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø–∞–ø–∫–∏ <strong>–ø–æ –¥–∞—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è</strong> ‚Äî —Å–∞–º–∞—è –≤–µ—Ä—Ö–Ω—è—è, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –≤–∞—à –ø–æ—Å–ª–µ–¥–Ω–∏–π
              –ø—Ä–æ–µ–∫—Ç.</p>
          </div>
          <div class="step-card">
            <span class="step-num">04</span>
            <p>–ó–∞–π–¥–∏—Ç–µ –≤ —ç—Ç—É –ø–∞–ø–∫—É. –í–Ω—É—Ç—Ä–∏ –Ω–∞–π–¥–∏—Ç–µ —Ñ–∞–π–ª <strong>draft_content.json</strong>.</p>
            <p>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –≤ –æ–±–ª–∞—Å—Ç—å –≤—ã—à–µ üëÜ.</p>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script>
    function fmt(ms) {
      ms = Math.max(0, ms | 0);
      const h = Math.floor(ms / 3600000);
      ms %= 3600000;
      const m = Math.floor(ms / 60000);
      ms %= 60000;
      const s = Math.floor(ms / 1000);
      const mm = ms % 1000;
      return String(h).padStart(2, '0') + ':' +
        String(m).padStart(2, '0') + ':' +
        String(s).padStart(2, '0') + ',' +
        String(mm).padStart(3, '0');
    }

    function extractText(mat) {
      for (const key of ['content', 'base_content']) {
        const v = mat?.[key];
        if (typeof v === 'string' && v.trim().startsWith('{')) {
          try {
            const obj = JSON.parse(v);
            if (obj && typeof obj.text === 'string' && obj.text.trim()) return obj.text;
          } catch { }
        }
      }
      return '';
    }

    function buildSrt(data, mode) {
      const texts = data?.materials?.texts ?? [];
      const textById = new Map(texts.filter(t => t && t.id).map(t => [t.id, t]));

      const entries = [];
      const tracks = data?.tracks ?? [];

      for (const tr of tracks) {
        if (tr?.type !== 'text') continue;
        for (const seg of (tr.segments ?? [])) {
          const mid = seg?.material_id;
          const mat = textById.get(mid);
          if (!mat) continue;

          // Mode Filtering Logic
          // mode = 'subs'  -> only materials with type === 'subtitle'
          // mode = 'all'   -> include everything from text tracks
          if (mode === 'subs' && mat?.type !== 'subtitle') continue;

          const tt = seg?.target_timerange ?? {};
          const startUs = tt.start;
          const durUs = tt.duration;
          if (typeof startUs !== 'number' || typeof durUs !== 'number') continue;

          const txt = extractText(mat).replace(/\r\n/g, '\n').replace(/\r/g, '\n').trim();
          if (!txt) continue;

          entries.push({
            startUs,
            endUs: startUs + durUs,
            text: txt,
          });
        }
      }

      entries.sort((a, b) => (a.startUs - b.startUs) || (a.endUs - b.endUs) || a.text.localeCompare(b.text));

      let out = '';
      for (let i = 0; i < entries.length; i++) {
        const e = entries[i];
        let startMs = Math.round(e.startUs / 1000);
        let endMs = Math.round(e.endUs / 1000);
        if (endMs <= startMs) endMs = startMs + 1;

        out += (i + 1) + '\n';
        out += fmt(startMs) + ' --> ' + fmt(endMs) + '\n';
        out += e.text + '\n\n';
      }
      return out;
    }

    // --- UI Interaction Logic ---
    const dropZone = document.getElementById('dropZone');
    const fileInput = document.getElementById('fileInput');
    const convertBtn = document.getElementById('convertBtn');
    const status = document.getElementById('status');
    const fileInfo = document.getElementById('fileInfo');
    const fileName = document.getElementById('fileName');

    let currentFile = null;
    let draftJson = null;

    // Handle Drag & Drop
    dropZone.addEventListener('click', (e) => {
      // Prevent click if clicking on the switch or button
      if (e.target.closest('.mode-switch') || e.target === convertBtn) return;
      fileInput.click();
    });

    dropZone.addEventListener('dragover', (e) => {
      e.preventDefault();
      dropZone.classList.add('drag-over');
    });

    dropZone.addEventListener('dragleave', () => {
      dropZone.classList.remove('drag-over');
    });

    dropZone.addEventListener('drop', (e) => {
      e.preventDefault();
      dropZone.classList.remove('drag-over');
      if (e.dataTransfer.files.length) {
        handleFile(e.dataTransfer.files[0]);
      }
    });

    fileInput.addEventListener('change', () => {
      if (fileInput.files.length) {
        handleFile(fileInput.files[0]);
      }
    });

    async function handleFile(file) {
      currentFile = file;
      fileName.textContent = file.name;
      fileInfo.style.display = 'flex';
      status.textContent = '';
      status.className = 'status-msg';
      convertBtn.classList.remove('active');

      if (!file.name.toLowerCase().endsWith('.json')) {
        status.textContent = '–û—à–∏–±–∫–∞: –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ .json —Ñ–∞–π–ª';
        status.className = 'status-msg error';
        return;
      }

      try {
        const text = await file.text();
        draftJson = JSON.parse(text);

        if (!draftJson.materials && !draftJson.tracks) {
          throw new Error("Invalid structure");
        }

        convertBtn.classList.add('active');
        status.textContent = '–§–∞–π–ª –≥–æ—Ç–æ–≤ –∫ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏';
        status.className = 'status-msg success';
      } catch (e) {
        console.error(e);
        status.textContent = '–û—à–∏–±–∫–∞: –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å JSON —Ñ–∞–π–ª';
        status.className = 'status-msg error';
        draftJson = null;
      }
    }

    convertBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      if (!draftJson) return;

      // Get active mode
      const mode = document.querySelector('input[name="mode"]:checked').value;

      try {
        const srt = buildSrt(draftJson, mode);
        if (!srt.trim()) {
          status.textContent = '–í –ø—Ä–æ–µ–∫—Ç–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è —Å—É–±—Ç–∏—Ç—Ä–æ–≤.';
          status.className = 'status-msg error';
          return;
        }

        const blob = new Blob([srt], { type: 'application/x-subrip;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = (currentFile.name.replace('.json', '') || 'subs') + '.srt';
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);

        status.textContent = '–£—Å–ø–µ—à–Ω–æ! –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –Ω–∞—á–∞–ª–æ—Å—å...';
        status.className = 'status-msg success';
      } catch (e) {
        console.error(e);
        status.textContent = '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ SRT.';
        status.className = 'status-msg error';
      }
    });

    function copyPath() {
      const text = document.getElementById('pathText').innerText;
      navigator.clipboard.writeText(text).then(() => {
        const btn = document.querySelector('.copy-btn');
        const originalText = btn.innerText;
        btn.innerText = '–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
        setTimeout(() => btn.innerText = originalText, 2000);
      });
    }
  </script>
</body>

</html>